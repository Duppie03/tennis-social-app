<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eldoraigne Tennis Club - Social Day</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@latest/css/materialdesignicons.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <img src="source/eldorainge-tennis-logo.png" alt="Club Logo" id="header-logo">
        <div class="header-buttons">
            <div id="weather-display"></div>
            <button id="historyBtn" class="header-btn secondary">
                <i class="mdi mdi-history"></i>
            </button>
        </div>
    </header>

    <div id="time-overlay">
        <div id="left-spacer"></div>
        <h1 id="header-clock" class="header-title">Social Day Manager</h1>
        <div id="right-spacer"></div>
    </div>

    <main class="container">
        <div id="info-bar" class="info-bar hidden">
            <p id="info-bar-text">Dynamic message goes here.</p>
        </div>
        
        <div class="content-columns">
            <section class="player-column">
                <div id="availablePlayersSection">
                    <div class="card-header">
                        <h3>Available Players</h3>
                        <button id="players-toggle-btn" class="settings-btn summary-toggle-btn" data-card-type="players" title="Toggle Details">
                            <i class="mdi mdi-chevron-up"></i>
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="player-list-controls">
                            <button id="checkInBtn" class="action-btn">Check In</button>
                            <button id="checkOutBtn" class="action-btn">Check Out</button>
                        </div>
                        <h4>Mode</h4>
                        <div class="mode-selector">
                            <button id="mode-doubles" class="mode-btn active">Doubles</button>
                            <button id="mode-singles" class="mode-btn">Singles</button>
                        </div>
                        
                        <div class="player-list-header">
                            <h4>Players</h4>
                            <div class="player-list-sub-headers">
                                <span class="header-sex">SEX</span>
                                <span class="header-time">TIME</span>
                            </div>
                        </div>

                        <ul id="availablePlayersList">
                        </ul>
                    </div>
                </div>
            </section>

            <section id="courtsSection">
                <div id="court-grid" class="court-grid">
                </div>
            </section>
        </div>
    </main>

    <div id="admin-settings-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header-with-actions">
                <h3>Admin Settings</h3>
                <div class="modal-header-icons">
                    <button id="ball-management-btn" class="admin-icon-btn" title="Ball Management">
                        ðŸŽ¾
                    </button>
                    <button id="light-management-btn" class="admin-icon-btn" title="Light Management">
                        <i class="mdi mdi-lightbulb-outline"></i>
                    </button>
                    <button id="select-sound-btn" class="admin-icon-btn" title="Select Alert Sound">ðŸ””</button>
                    <button id="reset-app-btn" class="admin-icon-btn" title="Reset Application Data">
                        <i class="mdi mdi-refresh"></i>
                    </button>
                </div>
            </div>
            
            <div class="admin-settings-grid-2col">
                <div class="admin-settings-panel">
                    <h4>Select Member on Duty</h4>
                    <ul id="committee-member-list" class="modal-action-list scrollable">
                    </ul>
                </div>
                <div class="admin-settings-panel">
                    <h4>Court Availability</h4>
                    <ul id="court-availability-list" class="court-availability-list">
                    </ul>
                </div>
            </div>
            <div class="modal-actions" style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; margin-top: 1.5rem; padding-top: 0.5rem;">
                <button id="view-reorder-log-btn" class="action-btn" style="background-color: #6c757d;">View Reorder Log</button>
                <button id="reorder-players-btn" class="action-btn" style="background-color: var(--primary-blue);">Reorder Players</button>
                <button id="manage-court-players-btn" class="action-btn" style="background-color: #007bff; border-color: #007bff;">Manage On-Court Players</button>
            </div>
            <div class="modal-actions" style="display: flex; justify-content: center; margin-top: 1rem; padding-top: 0;">
                <button id="admin-close-btn" style="flex-grow: 0; min-width: 150px;">Close</button>
            </div>
        </div>
    </div>
    
    <div id="sound-selection-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header-with-actions">
                <h3>Select Alert Sound</h3>
                <div class="modal-header-icons">
                    <button id="mute-btn" class="admin-icon-btn" title="Mute All Sounds">
                        <i class="mdi mdi-volume-high"></i>
                    </button>
                    <button id="minimize-notifications-btn" class="admin-icon-btn" title="Minimize Notifications">
                        <i class="mdi mdi-arrow-expand-vertical"></i>
                    </button>
                    <button id="no-speech-btn" class="admin-icon-btn" title="Turn Off Speech">
                        <i class="mdi mdi-microphone-message"></i>
                    </button>
                </div>
            </div>
            <p style="text-align: center; color: var(--neutral-color);">Choose the sound to play for notifications.</p>

            <div id="sound-selection-list" class="sound-selection-list scrollable">
            </div>

            <div class="modal-actions">
                <button id="sound-cancel-btn" class="action-btn">Cancel</button>
                <button id="sound-confirm-btn" class="action-btn" disabled>Confirm Selection</button>
            </div>
        </div>
    </div>

    <div id="reorder-log-modal" class="modal-overlay hidden">
        <div class="modal-content wide">
            <h3>Queue Reorder History</h3>
            <p>Log of all administrative changes to the player queue.</p>
            <div id="reorder-history-list" class="history-list scrollable" style="max-height: 400px; padding: 0;">
            </div>
            <div class="modal-actions">
                <button id="reorder-log-back-btn" class="action-btn" style="background-color: #6c757d;">Back to Settings</button>
            </div>
        </div>
    </div>

    <div id="reorder-players-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3>Reorder Available Players</h3>
            <p>Use the arrows to change the player queue order. The player at the top is first in line.</p>
            <ul id="reorder-players-list" class="modal-action-list scrollable">
            </ul>
            <div class="modal-actions">
                <button id="reorder-cancel-btn" class="action-btn" style="background-color: #6c757d;">Back to Settings</button>
                <button id="reorder-save-btn">Save Changes</button>
            </div>
        </div>
    </div>

    <div id="choose-teams-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3>Choose Teams</h3>
            <p>Select 2 players for Team 1.<br>The rest will be Team 2.</p>
            <div id="modal-player-list" class="modal-player-list"></div>
            <div class="modal-actions">
                <button id="modal-cancel-btn">Cancel</button>
                <button id="modal-confirm-teams-btn">Confirm Teams</button>                
            </div>
        </div>
    </div>

    <div id="cancel-confirm-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3>Confirm Action</h3>
            <p>Are you sure?</p>
            <div class="modal-actions">
                <button id="modal-btn-no" class="action-btn">Go Back</button>
                <button id="modal-btn-yes-confirm" class="action-btn">Yes</button>
            </div>
        </div>
    </div>

    <div id="guest-name-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3>Add New Player</h3>
            <div class="score-input-area" style="flex-direction: column; align-items: stretch;">
                <label for="guest-name-input">First Name:</label>
                <input type="text" id="guest-name-input" readonly placeholder="Tap to enter name">
            </div>
            <div class="score-input-area" style="flex-direction: column; align-items: stretch; margin-top: 1rem;">
                <label for="guest-surname-input">Surname:</label>
                <input type="text" id="guest-surname-input" readonly placeholder="Tap to enter surname">
            </div>
            
            <div class="gender-selector">
                <label>Gender:</label>
                <div class="radio-group">
                    <label>
                        <input type="radio" name="guest-gender" value="M" checked> Male
                    </label>
                    <label>
                        <input type="radio" name="guest-gender" value="F"> Female
                    </label>
                </div>
            </div>

            <div class="player-type-selector">
                <label>Player Type:</label>
                <div class="radio-group">
                    <label>
                        <input type="radio" name="player-type" value="guest" checked> Guest
                    </label>
                    <label>
                        <input type="radio" name="player-type" value="member"> Member
                    </label>
                </div>
            </div>
            <div class="modal-actions">
                <button id="guest-cancel-btn">Cancel</button>
                <button id="guest-confirm-btn" disabled>Confirm Player</button>
            </div>
        </div>
    </div>

    <div id="check-in-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3>Check In Player</h3>
            <p>Select a member, choose a returning guest, or add a new player.</p>
            <div class="list-container">
                <div id="check-in-abc-index" class="abc-index"></div>
                <ul id="check-in-list" class="modal-action-list scrollable"></ul>
            </div>
            <div class="modal-actions" style="grid-template-columns: 1fr 1fr; display: grid;">
                <button id="returning-guest-btn" class="action-btn neutral">Returning Guest</button>
                <button id="add-new-player-btn" class="action-btn">Add New Player</button>
            </div>
            <div class="modal-actions">
                <button id="check-in-cancel-btn">Close</button>
            </div>
        </div>
    </div>

    <div id="returning-guest-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3>Check In Returning Guest</h3>
            <p>Select the '+' next to the guest to check them in.</p>
            <div class="list-container">
                <div id="returning-guest-abc-index" class="abc-index"></div>
                <ul id="returning-guest-list" class="modal-action-list scrollable"></ul>
            </div>
            <div class="modal-actions">
                <button id="returning-guest-cancel-btn">Back</button>
            </div>
        </div>
    </div>

    <div id="check-out-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3>Check Out Player</h3>
            <p>Select the 'X' next to the player to check out.</p>
            <div class="list-container">
                <div id="check-out-abc-index" class="abc-index"></div>
                <ul id="check-out-list" class="modal-action-list scrollable"></ul>
            </div>
            <div class="modal-actions">
                <button id="check-out-cancel-btn">Close</button>
            </div>
        </div>
    </div>

    <div id="end-game-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3>Enter Game Results</h3>
            <p id="end-game-timestamp" style="font-size: 0.9rem; color: #6c757d; text-align: center; margin-top: -1rem; margin-bottom: 1.5rem;"></p>
            
            <div class="result-section">
                <h4>1. Select Winning Team</h4>
                <div id="end-game-teams">
                </div>
            </div>
    
            <div class="result-section hidden" id="score-section">
                <h4>2. Enter Final Score</h4>
                <div class="score-input-area">
                    <div class="score-input-wrapper winning">
                        <label for="winning-score">Winning Score</label>
                        <input type="number" id="winning-score" readonly>
                    </div>
                    <div class="score-input-wrapper losing">
                        <label for="losing-score">Losing Score</label>
                        <input type="number" id="losing-score" readonly>
                    </div>
                </div>
            </div>
            
            <div class="result-section hidden" id="tie-breaker-area">
                <h4>3. Enter Tie-Break Score</h4>
                   <div class="score-input-area">
                    <div class="score-input-wrapper winning">
                        <label for="winner-tiebreak">Winner's Points</label>
                        <input type="number" id="winner-tiebreak" readonly>
                    </div>
                    <div class="score-input-wrapper losing">
                        <label for="loser-tiebreak">Loser's Points</label>
                        <input type="number" id="loser-tiebreak" readonly>
                    </div>
                </div>
            </div>
    
            <div class="modal-actions">
                <button id="end-game-cancel-btn">Cancel</button>
                <button id="end-game-skip-btn" class="action-btn neutral">Skip Scores</button>
                <button id="end-game-confirm-btn" disabled>Confirm</button>
            </div>
        </div>
    </div>

    <div id="history-page" class="modal-overlay hidden">
        <div class="modal-content wide">
            <h3>Game History</h3>
            <div id="history-list" class="history-list scrollable">
            </div>
            <div class="modal-actions">
                <button id="history-toggle-view" class="action-btn">Show Player Stats</button>
                <button id="history-close-btn">Close</button>
            </div>
        </div>
    </div>

    <div id="custom-keypad-modal" class="modal-overlay hidden">
        <div class="keypad-content">
            <div id="keypad-display"></div>
            <div class="keypad-grid">
                <button class="keypad-btn" data-key="1">1</button>
                <button class="keypad-btn" data-key="2">2</button>
                <button class="keypad-btn" data-key="3">3</button>
                <button class="keypad-btn action" data-key="backspace">âŒ«</button>
                
                <button class="keypad-btn" data-key="4">4</button>
                <button class="keypad-btn" data-key="5">5</button>
                <button class="keypad-btn" data-key="6">6</button>
                <button class="keypad-btn action secondary" data-key="clear">C</button>
                
                <button class="keypad-btn" data-key="7">7</button>
                <button class="keypad-btn" data-key="8">8</button>
                <button class="keypad-btn" data-key="9">9</button>
                <button class="keypad-btn" data-key="0">0</button>

                <button class="keypad-btn wide-half cancel hidden" id="keypad-cancel-btn">Cancel</button>
                <button id="keypad-confirm-btn" class="keypad-btn wide-full confirm">Done</button>
            </div>
        </div>
    </div>

    <div id="custom-alpha-keypad-modal" class="modal-overlay hidden">
        <div class="keypad-content">
            <div id="alpha-keypad-display"></div>
            <div class="keypad-grid" id="alpha-keypad-grid">
            </div>
        </div>
    </div>
    
    <div id="manage-court-players-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3>Manage On-Court Players</h3>
            <p id="manage-court-players-instructions">Select a court with an active game.</p>
            
            <ul id="court-list-for-management" class="modal-action-list scrollable">
            </ul>
            
            <ul id="remove-players-list" class="modal-action-list scrollable hidden">
            </ul>
            
            <ul id="add-players-list" class="modal-action-list scrollable hidden">
            </ul>
                
            <div class="modal-actions">
                <button id="manage-players-back-btn" class="action-btn hidden" style="background-color: #6c757d;">Back</button>
                <button id="manage-players-add-btn" class="action-btn hidden" style="background-color: var(--confirm-color);">Add Player</button>
                <button id="manage-players-confirm-btn" class="action-btn hidden">Confirm</button>
                <button id="manage-players-close-btn" class="action-btn" style="background-color: #dc3545;">Close</button>
            </div>
        </div>
    </div>

    <div id="current-weather-modal" class="modal-overlay hidden">
        <div class="modal-content weather-modal">
            <div class="modal-header-with-actions">
                <h3>Current Weather</h3>
                <span id="cw-time">8:00 AM</span>
            </div>
            <div class="weather-main">
                <div class="weather-temp-icon">
                    <span id="cw-icon" class="weather-icon-large"></span>
                    <span id="cw-temp" class="weather-temp-large">15Â°</span>
                </div>
                <div class="weather-feels-like">
                    <p>RealFeelÂ® <span id="cw-realfeel">13Â°</span></p>
                    <p>RealFeel Shadeâ„¢ <span id="cw-realfeel-shade">13Â°</span></p>
                </div>
            </div>
            <p id="cw-description" class="weather-description">Cloudy</p>
            <div class="weather-grid">
                <div class="weather-item">
                    <span>Wind</span>
                    <strong id="cw-wind">WSW 15 km/h</strong>
                </div>
                <div class="weather-item">
                    <span>Wind Gusts</span>
                    <strong id="cw-wind-gusts">39 km/h</strong>
                </div>
                <div class="weather-item">
                    <span>Air Quality</span>
                    <strong id="cw-air-quality" class="aqi-poor">Poor</strong>
                </div>
            </div>
            <div class="modal-actions">
                <button id="cw-close-btn">Close</button>
                <button id="cw-more-details-btn" class="action-btn">More Details</button>
            </div>
        </div>
    </div>

    <div id="detailed-weather-modal" class="modal-overlay hidden">
        <div class="modal-content weather-modal wide">
            <div id="detailed-weather-content">
                <div class="weather-section">
                    <h4>Detailed Current Weather</h4>
                    <div class="weather-grid">
                        <div class="weather-item"><span>Max UV Index</span><strong id="dw-uv">0.4 (Low)</strong></div>
                        <div class="weather-item"><span>Dew Point</span><strong id="dw-dewpoint">12Â°</strong></div>
                        <div class="weather-item"><span>Humidity</span><strong id="dw-humidity">81%</strong></div>
                        <div class="weather-item"><span>Pressure</span><strong id="dw-pressure">â†‘ 1015 mb</strong></div>
                        <div class="weather-item"><span>Cloud Cover</span><strong id="dw-cloud-cover">95%</strong></div>
                        <div class="weather-item"><span>Visibility</span><strong id="dw-visibility">16 km</strong></div>
                    </div>
                </div>
                <div class="weather-section">
                    <div class="weather-tabs">
                        <button class="tab active" data-view="day">Day</button>
                        <button class="tab" data-view="morning">Morning</button>
                        <button class="tab" data-view="afternoon">Afternoon</button>
                    </div>
                    <div class="weather-main-forecast">
                        <div class="weather-temp-icon">
                            <span id="forecast-icon" class="weather-icon-large"></span>
                            <span id="forecast-temp" class="weather-temp-large">25Â°</span>
                        </div>
                        <div class="weather-feels-like">
                            <p>RealFeelÂ® <span id="forecast-realfeel">27Â°</span></p>
                            <p>RealFeel Shadeâ„¢ <span id="forecast-realfeel-shade">23Â°</span></p>
                        </div>
                    </div>
                    <p id="forecast-description" class="weather-description">A thunderstorm this morning; otherwise, clouds and sun</p>
                    <div id="forecast-grid" class="weather-grid">
                        </div>
                </div>
            </div>
            <div class="modal-actions">
                <button id="dw-close-btn">Close</button>
            </div>
        </div>
    </div>

    <div id="sign-out-member-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3 id="sign-out-member-title">Select Member Signing Out</h3>
            <p id="sign-out-member-prompt" style="color: var(--neutral-color);">Please select the member responsible for this ball sign-out.</p>
            <div class="admin-settings-panel" style="max-height: 400px; margin-top: 1rem;">
                <ul id="sign-out-member-list" class="modal-action-list scrollable">
                    </ul>
            </div>
            <div class="modal-actions">
                <button id="sign-out-member-cancel-btn" class="action-btn" style="background-color: var(--cancel-color);">Cancel</button>
                <button id="sign-out-member-confirm-btn" class="action-btn" disabled>Confirm Member</button>
            </div>
        </div>
    </div>
    <div id="ball-management-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header-with-actions">
                <h3>Ball Management</h3>
                <div class="modal-header-icons">
                    <button id="ball-history-btn" class="admin-icon-btn" title="Ball Transaction History">
                        <i class="mdi mdi-history"></i>
                    </button>
                </div>
            </div>
            <div class="ball-management-grid">
                
                <div class="admin-settings-panel">
                    <h4>Stock (Cans)</h4> 
                    <div class="stock-display-area">
                        <span id="ball-stock-count" class="stock-number">0</span>
                        <span class="stock-label">Cans in Stock</span>
                    </div>
                    <div class="stock-update-area">
                        <button id="add-stock-btn" class="action-btn" data-action="open-stock-keypad" style="background-color: var(--primary-blue);">Add Stock</button>
                        <button id="return-stock-btn" class="action-btn" data-action="open-return-keypad" style="background-color: var(--neutral-color);">Return Cans</button>
                    </div>
                </div>

                <div class="admin-settings-panel">
                    <h4>Sign Out (1 Can)</h4> 
                    <p style="font-size: 0.9em; color: var(--neutral-color); margin-top: 0.5rem; margin-bottom: 1rem;">
                        Category for ball usage. 
                    </p>
                    <div id="sign-out-options" class="sign-out-options scrollable">
                        <button class="action-btn sign-out-btn" data-category="ClubChamps">Club Champs</button>
                        <button class="action-btn sign-out-btn" data-category="League">League</button>
                        <button class="action-btn sign-out-btn" data-category="Social">Social</button>
                        <button class="action-btn sign-out-btn" data-category="Sale" style="background-color: var(--cancel-color);">Sale (R50)</button>
                    </div>
                </div>
            </div>
            
            <div class="modal-actions">
                <button id="ball-management-close-btn" class="action-btn">Done</button>
            </div>
        </div>
    </div>

    <div id="ball-history-modal" class="modal-overlay hidden">
        <div class="modal-content wide">
            <h3>Ball Transaction History</h3>
            <p>A log of all ball stock additions, returns, and sign-outs.</p>
            <div id="ball-history-list" class="history-list scrollable">
                </div>
            <div class="modal-actions">
                <button id="ball-history-close-btn">Close</button>
            </div>
        </div>
    </div>

    <div id="light-management-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3>Light Management</h3>
            <p>Control the court lights.</p>
            <div class="admin-settings-panel" style="max-height: 400px; margin-top: 1rem;">
                <ul id="light-availability-list" class="court-availability-list scrollable">
                    </ul>
            </div>
            <div class="modal-actions">
                <button id="light-management-close-btn" class="action-btn">Done</button>
            </div>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>